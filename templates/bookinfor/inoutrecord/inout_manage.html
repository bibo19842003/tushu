{% extends 'base.html' %}
{% block inout_manage_block %}<li class="active">{% endblock %}
{% block head_block %}In and Out Manage{% endblock %}

{% block body_block %}

<form action="" method="get">

  <div class="form-group">
      <div class="col-sm-2">
         <input type="text" class="form-control" name="phone" placeholder="请输入要搜索的手机号">
      </div>
  </div>

  <div class="form-group">
      <div class="col-sm-2">
         <input type="text" class="form-control" name="name" placeholder="请输入要搜索的书名">
      </div>
  </div>

  <div class="btn-group">
    <input type="submit" class="btn btn-default" name="querydata" value="搜索"></input>
    <button class="btn btn-default" type="button" data-toggle="modal" data-target="#new">新增</button>
  </div>


<hr class="hr" />


<div class="table-responsive">
  <table class="table table-condensed table-striped table-hover">

    <thead>
    <tr>
      <th>序号</th>
      <th>电话</th>
      <th>书名</th>
      <th>资产编码</th>
      <th>借出时间</th>
      <th>操作人出</th>
      <th>归还时间</th>
      <th>操作人还</th>
      <th>备注</th>
    </tr>
    </thead>

    <tbody>
    <tr>
      {% for inout in inout %}
      <tr class="info">
        <td>{{ forloop.counter }}</td>
        <td id="phonex" >
             <a href="/inout_modify/?phone={{ inout.phone }}&name={{ inout.name }}&cx=yinchang" target="_blank">{{ inout.phone }}</a>
        </td>
        <td id="namex">{{ inout.name }}</td>
        <td id="zcbmx">{{ inout.zcbm }}</td>
        <td id="outtimex">{{ inout.outtime }}</td>
        <td id="handleroutx">{{ inout.handlerout }}</td>
        <td id="intimex">{{ inout.intime }}</td>
        <td id="handlerin">{{ inout.handlerin }}</td>
        <td id="remarkx">{{ inout.remark }}</td>
      </tr>
      {% endfor %}
    </tr>
    </tbody>

  </table>
</div>



<!-- 模态框（Modal）新增 -->
<div class="modal fade" id="new" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">新增</h4>
                </div>

                <div class="modal-body">

   <div class="form-group">
      <label for="phonen">电话</label>
         <input type="text" class="form-control" name="phonen" id="phonen" placeholder="必须填写手机号，如 13912345678">
   </div>

   <div class="form-group">
      <label for="namen">书名</label>
         <input type="text" class="form-control" name="namen" id="namen" placeholder="14只老鼠大搬家">
   </div>

   <div class="form-group">
      <label for="zcbmn">资产编码</label>
         <input type="text" class="form-control" name="zcbmn" id="zcbmn" placeholder="暂不用填写">
   </div>


                    <div class="form-group">
                       <label for="remarkn">备注</label>
                       <input type="text" class="form-control" name="remarkn" id="remarkn" placeholder="备注">
                    </div>

                </div>

                <div class="modal-footer">
                     <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>关闭</button>
                     <input type="button" data-dissmiss="modal" onclick="newdata()" class="btn btn-primary" value="提交">
                </div>
        </div>
    </div>
</div>


<script>


//提交更改 新增
function newdata() {
	//获取模态框数据
	var phone = $('#phonen').val();
	var name = $('#namen').val();
	var zcbm = $('#zcbmn').val();
	var remark = $('#remarkn').val();

        $.ajaxSetup({
            data:{csrfmiddlewaretoken:'{{ csrf_token }}'},
        });

	$.ajax({
		type: "post",
		url: "/inout_out_new",
                data:{"phone":phone,
                      "name":name,
                      "zcbm":zcbm,
                      "remark":remark,
                      "csrfmiddlewaretoken":$("[name=‘csrfmiddlewaretoken‘]").val()
                      },

		success: function(result) {
			location.reload();
		}
	});
}


</script>



{% endblock %}
